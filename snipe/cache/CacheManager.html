<!DOCTYPE html>
<html lang="en"><head><meta charset="utf-8"/><link href="../../bootstrap/css/bootstrap.min.css" rel="stylesheet"/><link href="../../bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet"/><link href="../../bootstrap/css/bootstrap-select.min.css" rel="stylesheet"/><link href="http://fonts.googleapis.com/css?family=Open+Sans:400,700,700italic,400italic" rel="stylesheet" type="text/css"/><link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600,600italic,400" rel="stylesheet" type="text/css"/><link href="http://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.css" rel="stylesheet" type="text/css"/><script src="../../jquery-1.9.1.min.js"></script><script src="../../bootstrap/js/bootstrap.min.js"></script><script src="../../bootstrap/js/bootstrap-select.min.js"></script><link href="../../styles.css" rel="stylesheet"/><script type="text/javascript">var dox = {rootPath: "../../",platforms: ["uniserver","stats","index","script"]};</script><script type="text/javascript" src="../..//nav.js"></script><script type="text/javascript" src="../..//index.js"></script><link rel="icon" href="../..//favicon.png" type="image/png"></link><title>snipe.cache.CacheManager</title></head><body><nav class="navbar dark navbar-static-top" role="navigation">  <div class="container" style="height:45px;">   <div class="navbar-header"><!--
	    <a class="brand" href="http://haxe.org/"><img src="http://haxe.org/img/haxe-logo-horizontal-on-dark.svg" width="107" height="21" alt="Haxe" onerror="this.src='http://haxe.org/img/haxe-logo-horizontal-on-dark.png'"/></a>-->
        <span class="tagline"><a href="/">Snipe Server API Documentation</a></span><div class="pull-right"><!--
			<a href="http://haxe.org/download/" target="_blank">Download</a> |
			<a href="http://haxe.org/manual/" target="_blank">Read the manual</a>
-->
</div>   </div>  </div></nav><div class="container">        <div class="row-fluid">            <div class="span3">              <div class="well sidebar-nav">                <form class="form-search" id="searchForm">                  <div class="input-prepend input-block-level">                    <span class="add-on"><i class="icon-search"></i></span>                    <input id="search" type="text" placeholder="Search" autocomplete="off"/>                  </div>                </form><!--
				<div class="dropdown">
					<select id="select-platform" class="selectpicker" title="Filter by platform" data-width="100%">
						<option value="all" selected="true">All Platforms</option>
						::foreach i api.config.platforms::
							<option>::i::</option>
						::end::
					</select>
				</div>
-->
</div>              <div class="well sidebar-nav">                <div id="nav"></div>              </div>            </div>            <div class="span9"><div class="page-header">                    <h4><small>package snipe.cache</small></h4>    <h1>            <small>class</small>            CacheManager        </h1>                                </div><div class="body">        <div class="doc doc-main">            <div class="indent">                <p>Data cache manager.
Data blocks are described in detail in
<a target=_blank href="https://github.com/Mini-IT/SnipeWiki/wiki/DataBlocks">Data Blocks</a> article.</p>            </div>        </div>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <h3 class="section">Methods</h3>        <div class="fields">                                                                                        <div class="field "><a name="addModule"></a><h3><p><code>    <span class="label">inline</span> <a href="#addModule"><span class="identifier">addModule</span></a> (m:<a class="type" title="Dynamic is a special type which is compatible with all other types." href="../../Dynamic.html">Dynamic</a>):<a class="type" title="The standard Void type." href="../../Void.html">Void</a></code></p></h3><div class="doc"><p>Adds initialized cache module to list.</p>    <p class="javadoc">Parameters:</p>            <div class="indent inline-content">            <code>m</code> <p>Initialized cache module.</p>        </div>    </div></div>                                                                                                                            <div class="field "><a name="create"></a><h3><p><code>    <a href="#create"><span class="identifier">create</span></a> (serverID:<a class="type" title="The standard Int type." href="../../Int.html">Int</a>, type:<a class="type" title="The basic String class." href="../../String.html">String</a>, id:<a class="type" title="The standard Int type." href="../../Int.html">Int</a>, attrs:<a class="type" title="Dynamic is a special type which is compatible with all other types." href="../../Dynamic.html">Dynamic</a>, queryFunc:<a class="type" title="" href="../../snipe/cache/_QueryFunc.html">_QueryFunc</a>):<a class="type" title="Return type for block create operation." href="../../snipe/cache/_CacheCreateReturnType.html">_CacheCreateReturnType</a></code></p></h3><div class="doc"><p>Creates data block in database. Does not load it into memory.</p>    <p class="javadoc">Parameters:</p>            <div class="indent inline-content">            <code>serverID</code> <p>Slave server ID that does the operation.</p>        </div>            <div class="indent inline-content">            <code>type</code> <p>Data cache type.</p>        </div>            <div class="indent inline-content">            <code>id</code> <p>Data block ID.</p>        </div>            <div class="indent inline-content">            <code>attrs</code> <p>Optional. Data block attributes object.</p>        </div>            <div class="indent inline-content">            <code>queryFunc</code> <p>Optional. Function for making SQL query.
Will use one of the database manager connections by default.</p>        </div>        <p class="javadoc">Returns:</p>    <div class="indent inline-content">        <p>Operation status.</p>    </div></div></div>                                                                                                                            <div class="field "><a name="get"></a><h3><p><code>    <a href="#get"><span class="identifier">get</span></a> (serverID:<a class="type" title="The standard Int type." href="../../Int.html">Int</a>, type:<a class="type" title="The basic String class." href="../../String.html">String</a>, id:<a class="type" title="The standard Int type." href="../../Int.html">Int</a>, currentVersion:<a class="type" title="The standard Int type." href="../../Int.html">Int</a>, queryFunc:<a class="type" title="" href="../../snipe/cache/_QueryFunc.html">_QueryFunc</a>):<a class="type" title="Return type for block get operation." href="../../snipe/cache/_CacheReturnType.html">_CacheReturnType</a></code></p></h3><div class="doc"><p>Gets data block from cache and locks it for usage.
If the block is not in cache, loads it from database.</p>    <p class="javadoc">Parameters:</p>            <div class="indent inline-content">            <code>serverID</code> <p>Slave server ID that does the operation.</p>        </div>            <div class="indent inline-content">            <code>type</code> <p>Data cache type.</p>        </div>            <div class="indent inline-content">            <code>id</code> <p>Data block ID.</p>        </div>            <div class="indent inline-content">            <code>currentVersion</code> <p>Current block version.</p>        </div>            <div class="indent inline-content">            <code>queryFunc</code> <p>Optional. Function for making SQL query.
Will use one of the database manager connections by default.</p>        </div>        <p class="javadoc">Returns:</p>    <div class="indent inline-content">        <p>Operation status and block contents.</p>    </div></div></div>                                                                                                                            <div class="field "><a name="getAsync"></a><h3><p><code>    <a href="#getAsync"><span class="identifier">getAsync</span></a> (serverID:<a class="type" title="The standard Int type." href="../../Int.html">Int</a>, type:<a class="type" title="The basic String class." href="../../String.html">String</a>, id:<a class="type" title="The standard Int type." href="../../Int.html">Int</a>, params:<a class="type" title="Dynamic is a special type which is compatible with all other types." href="../../Dynamic.html">Dynamic</a>, postFunc:<a class="type" title="Asynchronous worker post function." href="../../snipe/cache/_AsyncWorkerFunc.html">_AsyncWorkerFunc</a>):<a class="type" title="The standard Void type." href="../../Void.html">Void</a></code></p></h3><div class="doc"><p>Gets data block from cache asynchronously and locks it for usage.
If the block is not in cache, loads it from database asynchronously.
Uses asynchronous database manager and asynchronous worker threads.</p>    <p class="javadoc">Parameters:</p>            <div class="indent inline-content">            <code>serverID</code> <p>Slave server ID that does the operation.</p>        </div>            <div class="indent inline-content">            <code>type</code> <p>Data cache type.</p>        </div>            <div class="indent inline-content">            <code>id</code> <p>Data block ID.</p>        </div>            <div class="indent inline-content">            <code>params</code> <p>Parameters given to callback function.</p>        </div>            <div class="indent inline-content">            <code>postFunc</code> <p>Function that runs after the block is loaded.
Will run in one of the asynchronous worker threads.
Called like this: <code>postFunc(async, serverID, params)</code>.
"params" is the parameters object given to function with additional "__return" field (snipe.cache._CacheReturnType class) that contains operation error code and cache block (block is null in case of error).</p>        </div>    </div></div>                                                                                                                            <div class="field "><a name="getServerID"></a><h3><p><code>    <a href="#getServerID"><span class="identifier">getServerID</span></a> (type:<a class="type" title="The basic String class." href="../../String.html">String</a>, id:<a class="type" title="The standard Int type." href="../../Int.html">Int</a>):<a class="type" title="The standard Int type." href="../../Int.html">Int</a></code></p></h3><div class="doc"><p>Gets slave server ID that has that data block locked.</p>    <p class="javadoc">Parameters:</p>            <div class="indent inline-content">            <code>type</code> <p>Data cache type.</p>        </div>            <div class="indent inline-content">            <code>id</code> <p>Data block ID.</p>        </div>        <p class="javadoc">Returns:</p>    <div class="indent inline-content">        <p>Slave server ID.</p>    </div></div></div>                                                                                                                            <div class="field "><a name="getUnlocked"></a><h3><p><code>    <a href="#getUnlocked"><span class="identifier">getUnlocked</span></a> (serverID:<a class="type" title="The standard Int type." href="../../Int.html">Int</a>, type:<a class="type" title="The basic String class." href="../../String.html">String</a>, id:<a class="type" title="The standard Int type." href="../../Int.html">Int</a>, currentVersion:<a class="type" title="The standard Int type." href="../../Int.html">Int</a>, queryFunc:<a class="type" title="" href="../../snipe/cache/_QueryFunc.html">_QueryFunc</a>):<a class="type" title="Return type for block get operation." href="../../snipe/cache/_CacheReturnType.html">_CacheReturnType</a></code></p></h3><div class="doc"><p>Gets data block from cache without locking it.
If the block is not in cache, loads it from database.</p>    <p class="javadoc">Parameters:</p>            <div class="indent inline-content">            <code>serverID</code> <p>Slave server ID that does the operation.</p>        </div>            <div class="indent inline-content">            <code>type</code> <p>Data cache type.</p>        </div>            <div class="indent inline-content">            <code>id</code> <p>Data block ID.</p>        </div>            <div class="indent inline-content">            <code>currentVersion</code> <p>Current block version.</p>        </div>            <div class="indent inline-content">            <code>queryFunc</code> <p>Optional. Function for making SQL query.
Will use one of the database manager connections by default.</p>        </div>        <p class="javadoc">Returns:</p>    <div class="indent inline-content">        <p>Operation status and block contents.</p>    </div></div></div>                                                                                                                            <div class="field "><a name="unlock"></a><h3><p><code>    <a href="#unlock"><span class="identifier">unlock</span></a> (serverID:<a class="type" title="The standard Int type." href="../../Int.html">Int</a>, type:<a class="type" title="The basic String class." href="../../String.html">String</a>, id:<a class="type" title="The standard Int type." href="../../Int.html">Int</a>):<a class="type" title="The standard Void type." href="../../Void.html">Void</a></code></p></h3><div class="doc"><p>Unlocks this data block.</p>    <p class="javadoc">Parameters:</p>            <div class="indent inline-content">            <code>serverID</code> <p>Slave server ID that does the operation.</p>        </div>            <div class="indent inline-content">            <code>type</code> <p>Data cache type.</p>        </div>            <div class="indent inline-content">            <code>id</code> <p>Data block ID.</p>        </div>    </div></div>                                                                                                                            <div class="field "><a name="update"></a><h3><p><code>    <a href="#update"><span class="identifier">update</span></a> (serverID:<a class="type" title="The standard Int type." href="../../Int.html">Int</a>, type:<a class="type" title="The basic String class." href="../../String.html">String</a>, id:<a class="type" title="The standard Int type." href="../../Int.html">Int</a>, diff:<a class="type" title="Data block diff type." href="../../snipe/cache/_BlockDiff.html">_BlockDiff</a>, doUnlock:<a class="type" title="The standard Boolean type, which can either be true or false." href="../../Bool.html">Bool</a>):<a class="type" title="Return type for block update operation." href="../../snipe/cache/_CacheUpdateReturnType.html">_CacheUpdateReturnType</a></code></p></h3><div class="doc"><p>Updates data block contents and increases version.</p>
<p>Must only be called on data blocks that are locked by this slave server.</p>    <p class="javadoc">Parameters:</p>            <div class="indent inline-content">            <code>serverID</code> <p>Slave server ID that does the operation.</p>        </div>            <div class="indent inline-content">            <code>type</code> <p>Data cache type.</p>        </div>            <div class="indent inline-content">            <code>id</code> <p>Data block ID.</p>        </div>            <div class="indent inline-content">            <code>diff</code> <p>Data block changes.</p>        </div>            <div class="indent inline-content">            <code>doUnlock</code> <p>If enabled, will unlock data block after the update.</p>        </div>        <p class="javadoc">Returns:</p>    <div class="indent inline-content">        <p>Operation status.</p>    </div></div></div>                                                                                                                            <div class="field "><a name="updateRaw"></a><h3><p><code>    <a href="#updateRaw"><span class="identifier">updateRaw</span></a> (serverID:<a class="type" title="The standard Int type." href="../../Int.html">Int</a>, type:<a class="type" title="The basic String class." href="../../String.html">String</a>, id:<a class="type" title="The standard Int type." href="../../Int.html">Int</a>, obj:<a class="type" title="Dynamic is a special type which is compatible with all other types." href="../../Dynamic.html">Dynamic</a>):<a class="type" title="Return type for block update operation." href="../../snipe/cache/_CacheUpdateReturnType.html">_CacheUpdateReturnType</a></code></p></h3><div class="doc"><p>Updates data block contents and increases version using anonymous object instead of diff.</p>
<p>Must only be called on data blocks that are locked by this slave server.</p>
<p>Mainly used by the editor.</p>    <p class="javadoc">Parameters:</p>            <div class="indent inline-content">            <code>serverID</code> <p>Slave server ID that does the operation.</p>        </div>            <div class="indent inline-content">            <code>type</code> <p>Data cache type.</p>        </div>            <div class="indent inline-content">            <code>id</code> <p>Data block ID.</p>        </div>            <div class="indent inline-content">            <code>obj</code> <p>Data block changes as an anonymous object.</p>        </div>        <p class="javadoc">Returns:</p>    <div class="indent inline-content">        <p>Operation status.</p>    </div></div></div>                                                                                                                            <div class="field "><a name="updated"></a><h3><p><code>    <a href="#updated"><span class="identifier">updated</span></a> (serverID:<a class="type" title="The standard Int type." href="../../Int.html">Int</a>, type:<a class="type" title="The basic String class." href="../../String.html">String</a>, id:<a class="type" title="The standard Int type." href="../../Int.html">Int</a>):<a class="type" title="The standard Void type." href="../../Void.html">Void</a></code></p></h3><div class="doc"><p>Marks the block as updated. This method should be used if you've made some changes in the block with <code><a href="../../snipe/cache/Block.html#set">Block.set</a>()</code> on the cache server.</p>
<p>Must only be called on data blocks that are locked by this slave server.</p>    <p class="javadoc">Parameters:</p>            <div class="indent inline-content">            <code>serverID</code> <p>Slave server ID that does the operation.</p>        </div>            <div class="indent inline-content">            <code>type</code> <p>Data cache type.</p>        </div>            <div class="indent inline-content">            <code>id</code> <p>Data block ID.</p>        </div>    </div></div>                                                        </div>                            </div></div>        </div></div><footer class="section dark site-footer"><div class="container"><div class="copyright"><p>&copy;2017&nbsp;<a href="http://mini-it.ru/index_en.htm" title="Mini IT Website" class="hf-link">Mini IT Ltd</a></p></div></div></footer>    <script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script></body></html>